{% extends "base.html" %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 py-8">
  <div class="flex items-center justify-between mb-6">
    <h1 class="text-3xl font-semibold text-gray-900">Cottage Chooser – User Guide</h1>
    <a href="{{ url_for('cottages') }}" class="text-blue-600 hover:text-blue-700" data-tooltip="Back to the cottage list">
      &larr; Back to Cottages
    </a>
  </div>

  <p class="text-gray-700 mb-6">
    Welcome to Cottage Chooser. This guide explains how to browse cottages, vote, rate, add entries, and follow the rules.
    Turn on Help Mode to see inline tips on buttons and links.
  </p>

  <div class="space-y-10">

    <section id="quick-start">
      <h2 class="text-2xl font-semibold text-gray-900 mb-3">Quick Start</h2>
      <ol class="list-decimal ml-6 space-y-2 text-gray-700">
        <li><strong>Join/Login:</strong> Use the "Login" link in the top-right to join the group with the group code.</li>
        <li><strong>Browse:</strong> Open "List Cottages" to see all entries, or "Compare" to view side by side.</li>
        <li><strong>Details:</strong> Click "Details" on any cottage to view photos, features, and comments.</li>
        <li><strong>Rate:</strong> Use the 0-10 rating buttons on each cottage card to rate properties. You can rate multiple cottages.</li>
        <li><strong>Vote:</strong> Click "Vote" on your favorite cottage. You can only have one vote at a time.</li>
        <li><strong>Results:</strong> Open "Results" to see rankings by votes and ratings. You can delete your vote there if you want to change it.</li>
        <li><strong>Help Mode:</strong> Click the floating "Help" button to show tooltips on interactive elements.</li>
      </ol>
    </section>

    <section id="rating">
      <h2 class="text-2xl font-semibold text-gray-900 mb-3">Rating System (0-10)</h2>
      <ul class="list-disc ml-6 space-y-2 text-gray-700">
        <li><strong>Rating vs Voting:</strong> Ratings (0-10 scale) allow you to score multiple cottages. Voting (single choice) indicates your top preference.</li>
        <li><strong>How to Rate:</strong> On the cottage list, click any number button (0-10) to submit your rating for that cottage.</li>
        <li><strong>Change Rating:</strong> Click a different number to update your rating, or click "Clear my rating" to remove it entirely.</li>
        <li><strong>View Ratings:</strong> Click the "Ratings" button on any cottage to see:
          <ul class="list-disc ml-6 mt-1">
            <li>Overall statistics (count, average, total score)</li>
            <li>Your own rating and when you submitted it</li>
            <li>(Admin only) All individual ratings from all users</li>
          </ul>
        </li>
        <li><strong>Results Display:</strong> The Results and List pages show average rating, rating count, and total score for each cottage.</li>
        <li>Be fair: rate based on the property's features, location, and value. Don't artificially inflate or deflate ratings.</li>
      </ul>
    </section>

    <section id="voting">
      <h2 class="text-2xl font-semibold text-gray-900 mb-3">Voting</h2>
      <ul class="list-disc ml-6 space-y-2 text-gray-700">
        <li><strong>One vote per user</strong> at a time. To change your choice, delete your existing vote on the Results page and vote again.</li>
        <li>You must be logged in (joined) to vote.</li>
        <li>Results update automatically. Ties may be resolved by a follow‑up vote or admin decision.</li>
        <li>Be fair: no duplicate accounts, and don't vote on behalf of others.</li>
        <li>Votes are public: other users can see who voted for each cottage on the details page.</li>
      </ul>
    </section>

    <section id="add-cottage">
      <h2 class="text-2xl font-semibold text-gray-900 mb-3">Adding and Editing Cottages</h2>
      <ul class="list-disc ml-6 space-y-2 text-gray-700">
        <li>Use "Add Cottage" to submit a new entry. Include name, location, price, beds, features, and a booking link.</li>
        <li><strong>Images:</strong> Provide a valid image URL. Large images are fine; they'll be scaled automatically.</li>
        <li><strong>Features:</strong> Mark amenities accurately:
          <ul class="list-disc ml-6 mt-1">
            <li>Dogs allowed</li>
            <li>Hot tub</li>
            <li>Secure garden</li>
            <li>EV charging</li>
            <li>Parking</li>
            <li>Log burner</li>
            <li>High chair</li>
            <li>Cot</li>
          </ul>
        </li>
        <li><strong>Descriptions:</strong> Support basic HTML formatting (paragraphs, bold, lists). Keep them concise and relevant.</li>
        <li><strong>Editing:</strong> You can edit cottages you submitted. Click "Edit" on the details page.</li>
        <li><strong>Deleting:</strong> You can delete cottages you submitted. Admins may also remove entries that break rules.</li>
        <li><strong>AI Review Summary:</strong> Field available for manual entry (optional). Admins can add a summary to help users.</li>
      </ul>
    </section>

    <section id="details-page">
      <h2 class="text-2xl font-semibold text-gray-900 mb-3">Cottage Details, Comments, and Reviews</h2>
      <ul class="list-disc ml-6 space-y-2 text-gray-700">
        <li>Details page shows the overview, features, voter list, and any user comments.</li>
        <li><strong>Comments:</strong> Be respectful and constructive. No spam, advertising, or personal data.</li>
        <li>You can edit or delete your own comments.</li>
        <li>Admins can delete any comment if it violates rules.</li>
      </ul>
    </section>

    <section id="results">
      <h2 class="text-2xl font-semibold text-gray-900 mb-3">Results Page</h2>
      <ul class="list-disc ml-6 space-y-2 text-gray-700">
        <li>See current rankings by vote count and rating statistics.</li>
        <li><strong>Vote Management:</strong> "Delete my vote" appears on the row of the cottage you voted for (when logged in).</li>
        <li><strong>Rating Display:</strong> Each cottage shows:
          <ul class="list-disc ml-6 mt-1">
            <li>Average rating (0-10 scale)</li>
            <li>Number of ratings</li>
            <li>Total rating score</li>
          </ul>
        </li>
        <li><strong>Admin Controls:</strong> Admins can manage votes (view and delete any vote) and view all individual ratings to resolve mistakes or rule violations.</li>
      </ul>
    </section>

    <section id="presentation">
      <h2 class="text-2xl font-semibold text-gray-900 mb-3">Presentation</h2>
      <p class="text-gray-700">
        Use "Presentation" to step through the shortlisted cottages during a meeting. You can download slides if enabled.
      </p>
    </section>

    <section id="compare">
      <h2 class="text-2xl font-semibold text-gray-900 mb-3">Compare Cottages</h2>
      <p class="text-gray-700">
        The "Compare" page allows you to view multiple cottages side-by-side to easily compare features, prices, and amenities.
      </p>
    </section>

    <section id="rules">
      <h2 class="text-2xl font-semibold text-gray-900 mb-3">Rules of Use</h2>
      <ul class="list-disc ml-6 space-y-2 text-gray-700">
        <li><strong>Honesty:</strong> One account per person. One active vote at a time. Rate fairly based on actual merit.</li>
        <li><strong>Respect:</strong> Keep comments civil. No harassment, hate speech, or inappropriate content.</li>
        <li><strong>Relevance:</strong> Only add cottages that meet the group's criteria (budget, location, amenities).</li>
        <li><strong>Accuracy:</strong> Use correct prices, locations, and features. Link to reputable booking sites.</li>
        <li><strong>Privacy:</strong> Do not post sensitive personal information.</li>
        <li><strong>Fair Rating:</strong> Don't manipulate ratings by creating multiple accounts or coordinating with others.</li>
        <li><strong>Moderation:</strong> Admins may edit/remove content, votes, or ratings that break these rules.</li>
      </ul>
    </section>

    <section id="faq">
      <h2 class="text-2xl font-semibold text-gray-900 mb-3">FAQ & Troubleshooting</h2>
      <div class="space-y-4">
        <details class="bg-white shadow rounded p-4">
          <summary class="font-medium text-gray-900 cursor-pointer">What's the difference between rating and voting?</summary>
          <p class="mt-2 text-gray-700">
            <strong>Rating (0-10):</strong> Score multiple cottages to indicate quality/preference. Helps with overall assessment.<br>
            <strong>Voting (single choice):</strong> Your final pick for the group's chosen cottage. You can only vote for one at a time.
          </p>
        </details>
        
        <details class="bg-white shadow rounded p-4">
          <summary class="font-medium text-gray-900 cursor-pointer">Can I change my rating?</summary>
          <p class="mt-2 text-gray-700">Yes! Click a different number (0-10) to update, or click "Clear my rating" to remove it completely.</p>
        </details>
        
        <details class="bg-white shadow rounded p-4">
          <summary class="font-medium text-gray-900 cursor-pointer">How many cottages can I rate?</summary>
          <p class="mt-2 text-gray-700">You can rate as many cottages as you want (0-10 each), but you can only vote for one cottage at a time.</p>
        </details>

        <details class="bg-white shadow rounded p-4">
          <summary class="font-medium text-gray-900 cursor-pointer">I can't vote.</summary>
          <p class="mt-2 text-gray-700">Make sure you're logged in (joined). If you already voted, delete your current vote on the Results page first.</p>
        </details>

        <details class="bg-white shadow rounded p-4">
          <summary class="font-medium text-gray-900 cursor-pointer">"Delete my vote" isn't visible.</summary>
          <p class="mt-2 text-gray-700">It only shows for the cottage you voted for and when you're logged in. Check the Results page.</p>
        </details>

        <details class="bg-white shadow rounded p-4">
          <summary class="font-medium text-gray-900 cursor-pointer">Can I see who rated each cottage?</summary>
          <p class="mt-2 text-gray-700">Regular users can only see their own ratings and overall statistics. Admin users can view all individual ratings on the Ratings detail page.</p>
        </details>

        <details class="bg-white shadow rounded p-4">
          <summary class="font-medium text-gray-900 cursor-pointer">Tooltips aren't showing.</summary>
          <p class="mt-2 text-gray-700">Click the floating "Help" button to enable Help Mode, then hover links and buttons.</p>
        </details>

        <details class="bg-white shadow rounded p-4">
          <summary class="font-medium text-gray-900 cursor-pointer">The site looks unstyled.</summary>
          <p class="mt-2 text-gray-700">Do a hard refresh (Ctrl+F5). If it persists, try another browser or contact an admin.</p>
        </details>
      </div>
    </section>

    <div class="mt-10 flex items-center gap-3">
      <a href="{{ url_for('cottages') }}" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded" data-tooltip="Back to the cottage list">Back to Cottages</a>
      <a href="{{ url_for('results') }}" class="bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded" data-tooltip="Open the results page">View Results</a>
      <a href="{{ url_for('tech_support') }}" class="bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded" data-tooltip="Technical documentation">Tech Support</a>
    </div>
  </div>
</div>
{% endblock %}